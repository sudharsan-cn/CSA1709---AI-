import numpy as np

X = np.array([[0,0],[0,1],[1,0],[1,1]])
y = np.array([[0],[1],[1],[0]])
np.random.seed(1); w1 = np.random.randn(2,2); w2 = np.random.randn(2,1)

for _ in range(10000):
    h = 1/(1+np.exp(-(X.dot(w1))))      # hidden layer
    o = 1/(1+np.exp(-(h.dot(w2))))      # output layer
    w2 += h.T.dot((y-o)*o*(1-o))*0.5    # backprop update
    w1 += X.T.dot(((y-o)*o*(1-o)).dot(w2.T)*h*(1-h))*0.5

print(np.round(o,3))
